---
title: "Untitled"
output: html_document
date: "2023-12-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("networkD3")
# Load package
library(networkD3)
library(tidyverse)
library(here)
 
```

```{r}

# Load energy projection data
links<-read.csv(here("input_data/DPSIR_NbS_links.csv")) 
nodes<-read.csv(here("input_data/DPSIR_NbS_nodes.csv")) 


length(unique(c(links$source, links$target)))
length(nodes$node)
```

```{r}
test<-full_join(links, nodes, by = c("source" = "X")) %>% 
  rename(Source_name = node) %>% 
  full_join(., nodes, by = c("target" = "X")) %>% 
  rename(Target_name = node)

table(test$Source_name)
table(test$Target_name)
```




```{r}
 
# Thus we can plot it
p <- sankeyNetwork(Links = links, Nodes = nodes, Source = "source",
              Target = "target", Value = "value", NodeID = "node",
              units = "TWh", fontSize = 20, nodeWidth = 30)
p
```


```{r}
# save the widget
 #library(htmlwidgets)
 #saveWidget(p, file=paste0(here("figures/sankeyConstructionGippsland.html")))
```

```{r}
saveNetwork(network = p, file = here("figures/Threat_Vul_sankey.html"))
```




